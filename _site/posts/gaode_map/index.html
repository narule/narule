<h1 id="高德地图使用">高德地图使用</h1>
<p>api地址
https://lbs.amap.com/api/javascript-api/summary
高德地图有提供公共接口，查看api，能实现一些项目基本需求效果</p>
<h2 id="基本使用">基本使用</h2>

<h3 id="注册帐号">注册帐号</h3>
<p>使用高德api，首先需要注册帐号，并且申请key(以个人或者公司的名字)，获取key后才能使用高德地图API去使用开发地图相关功能</p>

<h3 id="高德地图使用省图显示路线规划行车轨迹">高德地图使用，省图显示，路线规划，行车轨迹</h3>
<p><img src="https://img2020.cnblogs.com/blog/1436620/202005/1436620-20200519090747402-1624071223.png" alt="" /></p>

<p>行车路线规划
 <img src="https://img2020.cnblogs.com/blog/1436620/202005/1436620-20200519091007933-1512399553.png" alt="" /></p>

<p>已行驶轨迹绘制
 <img src="https://img2020.cnblogs.com/blog/1436620/202005/1436620-20200519091124218-2033211035.png" alt="" /></p>

<h4 id="monitorhtml">monitor.html</h4>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">'X-UA-Compatible'</span> <span class="na">content=</span><span class="s">'IE=edge'</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"initial-scale=1.0, user-scalable=no, width=device-width"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;style&gt;</span>
        <span class="nt">html</span><span class="o">,</span>
        <span class="nt">body</span><span class="o">,</span>
        <span class="nf">#container</span> <span class="p">{</span>
            <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
            <span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
            <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="nt">&lt;/style&gt;</span>
    <span class="nt">&lt;title&gt;</span>车辆配送行程监控<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"width: 800px;height: 800px; position: absolute; top: 50%; left: 50%;transform: translate(-50%, -50%);"</span><span class="nt">&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"container"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"input-card"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h4&gt;</span>选择省份<span class="nt">&lt;/h4&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"code-list"</span> <span class="na">id=</span><span class="s">"adcode-list"</span> <span class="na">style=</span><span class="s">"height: 28px;margin-right: 10px;"</span> <span class="na">onchange=</span><span class="s">"changeAdcode(this.value)"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"-1"</span><span class="nt">&gt;</span>选择省份<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;h4&gt;</span>选择层级<span class="nt">&lt;/h4&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"code-list"</span> <span class="na">style=</span><span class="s">"height: 28px;margin-right: 10px;"</span> <span class="na">onchange=</span><span class="s">"changeDepth(this.value)"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"0"</span><span class="nt">&gt;</span>0 - 显示省级<span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">selected</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>1 - 显示市级<span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>2 - 显示区/县级<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://webapi.amap.com/maps?v=1.4.15&amp;key=你申请的key&amp;plugin=Map3D,AMap.DistrictLayer,AMap.Scale,AMap.ToolBar,AMap.TruckDriving"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://a.amap.com/Loca/static/mock/adcodes.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"./js/monitor_map.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
    
   
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="c1">// 构造下拉框</span>
    <span class="kd">var</span> <span class="nx">optArr</span> <span class="o">=</span> <span class="nx">adcodes</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">adcode</span> <span class="o">==</span> <span class="mi">100000</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">item</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">选择省份</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">adcode</span> <span class="o">==</span> <span class="mi">440000</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">adcode</span> <span class="o">==</span> <span class="mi">450000</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">adcode</span> <span class="o">==</span> <span class="mi">530000</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">adcode</span> <span class="o">==</span> <span class="mi">520000</span> <span class="o">||</span>  <span class="nx">item</span><span class="p">.</span><span class="nx">adcode</span> <span class="o">==</span> <span class="mi">460000</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="dl">'</span><span class="s1">&lt;option </span><span class="dl">'</span> <span class="o">+</span> <span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">adcode</span> <span class="o">==</span> <span class="nx">adCode</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">selected</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">''</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> value="</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">adcode</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">"&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/option&gt;</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">//item.adCode == 360000 ||江西</span>
    <span class="p">});</span>

    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">adcode-list</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">optArr</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<h4 id="monitor_mapjs">monitor_map.js</h4>
<p>内容：自定义地图js API使用示例</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 
<span class="c1">//首先或一个地图（对象）</span>
 <span class="kd">var</span> <span class="nx">adCode</span> <span class="o">=</span> <span class="mi">440000</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">depth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nb">Map</span><span class="p">(</span><span class="dl">"</span><span class="s2">container</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
     <span class="na">resizeEnable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
     <span class="na">zoom</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
     <span class="na">center</span><span class="p">:</span> <span class="p">[</span><span class="mf">113.23333</span><span class="p">,</span> <span class="mf">23.26667</span><span class="p">],</span>
     <span class="na">pitch</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="na">viewMode</span><span class="p">:</span> <span class="dl">'</span><span class="s1">3D</span><span class="dl">'</span><span class="p">,</span>
 <span class="p">});</span>



 <span class="c1">// 创建省份图层</span>
 <span class="kd">var</span> <span class="nx">disProvince</span><span class="p">;</span>
 <span class="kd">function</span> <span class="nx">initPro</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="nx">dep</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">dep</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">dep</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span> <span class="p">?</span> <span class="mi">2</span> <span class="p">:</span> <span class="nx">dep</span><span class="p">;</span>
     <span class="nx">adCode</span> <span class="o">=</span> <span class="nx">code</span><span class="p">;</span>
     <span class="nx">depth</span> <span class="o">=</span> <span class="nx">dep</span><span class="p">;</span>

     <span class="nx">disProvince</span> <span class="o">&amp;&amp;</span> <span class="nx">disProvince</span><span class="p">.</span><span class="nx">setMap</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

     <span class="nx">disProvince</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nx">DistrictLayer</span><span class="p">.</span><span class="nx">Province</span><span class="p">({</span>
         <span class="na">zIndex</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
         <span class="na">adcode</span><span class="p">:</span> <span class="p">[</span><span class="nx">code</span><span class="p">],</span>
         <span class="na">depth</span><span class="p">:</span> <span class="nx">dep</span><span class="p">,</span>
         <span class="na">styles</span><span class="p">:</span> <span class="p">{</span>
             <span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">properties</span><span class="p">)</span> <span class="p">{</span>
                 <span class="c1">// properties为可用于做样式映射的字段，包含</span>
                 <span class="c1">// NAME_CHN:中文名称</span>
                 <span class="c1">// adcode_pro</span>
                 <span class="c1">// adcode_cit</span>
                 <span class="c1">// adcode</span>
                 <span class="kd">var</span> <span class="nx">adcode</span> <span class="o">=</span> <span class="nx">properties</span><span class="p">.</span><span class="nx">adcode</span><span class="p">;</span>
                 <span class="k">return</span> <span class="nx">getColorByAdcode</span><span class="p">(</span><span class="nx">adcode</span><span class="p">);</span>
             <span class="p">},</span>
             <span class="dl">'</span><span class="s1">province-stroke</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">cornflowerblue</span><span class="dl">'</span><span class="p">,</span>
             <span class="dl">'</span><span class="s1">city-stroke</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">white</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// 中国地级市边界</span>
             <span class="dl">'</span><span class="s1">county-stroke</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">rgba(255,255,255,0.5)</span><span class="dl">'</span> <span class="c1">// 中国区县边界</span>
         <span class="p">}</span>
     <span class="p">});</span>

     <span class="nx">disProvince</span><span class="p">.</span><span class="nx">setMap</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span>
 <span class="p">}</span>

 
 <span class="c1">// 颜色辅助方法</span>
 <span class="kd">var</span> <span class="nx">colors</span> <span class="o">=</span> <span class="p">{};</span>
 <span class="kd">var</span> <span class="nx">getColorByAdcode</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">adcode</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">colors</span><span class="p">[</span><span class="nx">adcode</span><span class="p">])</span> <span class="p">{</span>
         <span class="kd">var</span> <span class="nx">gb</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">155</span> <span class="o">+</span> <span class="mi">50</span><span class="p">;</span>
         <span class="nx">colors</span><span class="p">[</span><span class="nx">adcode</span><span class="p">]</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">rgba(</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">gb</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">,</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">gb</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">,255,0.45)</span><span class="dl">'</span><span class="p">;</span>
     <span class="p">}</span>

     <span class="k">return</span> <span class="nx">colors</span><span class="p">[</span><span class="nx">adcode</span><span class="p">];</span>
 <span class="p">};</span>

<span class="c1">// 五省中心经纬度</span>
 <span class="kd">var</span> <span class="nx">centerMapLng</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
 <span class="kd">var</span> <span class="nx">centerMapLat</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
 <span class="c1">//lng; //经度</span>
 <span class="c1">//lat; //纬度</span>
 <span class="nx">centerMapLng</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">530000</span><span class="dl">"</span><span class="p">,</span><span class="mf">102.72</span><span class="p">);</span>
 <span class="nx">centerMapLat</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">530000</span><span class="dl">"</span><span class="p">,</span><span class="mf">25.05</span><span class="p">);</span>

 <span class="nx">centerMapLng</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">440000</span><span class="dl">"</span><span class="p">,</span><span class="mf">113.23333</span><span class="p">);</span>
 <span class="nx">centerMapLat</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">440000</span><span class="dl">"</span><span class="p">,</span><span class="mf">23.26667</span><span class="p">);</span>

 <span class="nx">centerMapLng</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">520000</span><span class="dl">"</span><span class="p">,</span><span class="mf">106.63</span><span class="p">);</span>
 <span class="nx">centerMapLat</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">520000</span><span class="dl">"</span><span class="p">,</span><span class="mf">26.65</span><span class="p">);</span>

 <span class="nx">centerMapLng</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">450000</span><span class="dl">"</span><span class="p">,</span><span class="mf">108.22</span><span class="p">);</span>
 <span class="nx">centerMapLat</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">450000</span><span class="dl">"</span><span class="p">,</span><span class="mf">22.48</span><span class="p">);</span>

 <span class="nx">centerMapLng</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">460000</span><span class="dl">"</span><span class="p">,</span><span class="mf">110.32</span><span class="p">);</span>
 <span class="nx">centerMapLat</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">460000</span><span class="dl">"</span><span class="p">,</span><span class="mf">20.03</span><span class="p">);</span>
 <span class="c1">// 按钮事件</span>
 <span class="kd">function</span> <span class="nx">changeAdcode</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="nx">code</span> <span class="o">!=</span> <span class="mi">100000</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">initPro</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="nx">depth</span><span class="p">);</span>
         <span class="nx">setCenter</span><span class="p">(</span><span class="nx">code</span><span class="p">);</span>
     <span class="p">}</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nx">setCenter</span><span class="p">(</span><span class="nx">code</span><span class="p">){</span>
     <span class="kd">var</span> <span class="nx">lng</span> <span class="o">=</span> <span class="nx">centerMapLng</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">code</span><span class="p">);</span>
     <span class="kd">var</span> <span class="nx">lat</span> <span class="o">=</span> <span class="nx">centerMapLat</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span>
     <span class="nx">map</span><span class="p">.</span><span class="nx">setCenter</span><span class="p">([</span><span class="nx">lng</span><span class="p">,</span><span class="nx">lat</span><span class="p">]);</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nx">changeDepth</span><span class="p">(</span><span class="nx">dep</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">initPro</span><span class="p">(</span><span class="nx">adCode</span><span class="p">,</span> <span class="nx">dep</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="nx">initPro</span><span class="p">(</span><span class="nx">adCode</span><span class="p">,</span> <span class="nx">depth</span><span class="p">);</span>

 <span class="c1">//设置地图显示范围</span>
 <span class="kd">var</span> <span class="nx">mybounds</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nx">Bounds</span><span class="p">([</span><span class="mi">73</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">135</span><span class="p">,</span><span class="mi">53</span><span class="p">]);</span> <span class="c1">// 设置经纬度边界  [西南经纬度,东北经纬度]</span>
 <span class="c1">//map.setBounds(mybounds); //会将地图放大</span>
 <span class="nx">map</span><span class="p">.</span><span class="nx">setLimitBounds</span><span class="p">(</span><span class="nx">mybounds</span><span class="p">);</span>


 <span class="c1">// 路线规划，需要有起点和重点经纬度</span>

 <span class="c1">//起点latitude: "23.167439" longitude: "113.46625"</span>
 <span class="c1">//latitude: "23.00637" longitude: "113.124749" 终点 佛山医院</span>
 <span class="kd">var</span> <span class="nx">truckDriving</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nx">TruckDriving</span><span class="p">({</span>
     <span class="na">policy</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// 规划策略</span>
     <span class="na">size</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// 车型大小</span>
     <span class="na">width</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="c1">// 宽度</span>
     <span class="na">height</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="c1">// 高度      </span>
     <span class="na">load</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// 载重</span>
     <span class="na">weight</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="c1">// 自重</span>
     <span class="na">axlesNum</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="c1">// 轴数</span>
     <span class="na">province</span><span class="p">:</span> <span class="dl">'</span><span class="s1">京</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// 车辆牌照省份</span>
 <span class="p">})</span>


 <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="p">[]</span>
 <span class="nx">path</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="na">lnglat</span><span class="p">:[</span><span class="mf">113.46625</span><span class="p">,</span> <span class="mf">23.167439</span><span class="p">]});</span><span class="c1">//起点</span>
 <span class="c1">//path.push({lnglat:[113.324749, 23.107439]});//途径</span>
 <span class="nx">path</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="na">lnglat</span><span class="p">:[</span><span class="mf">113.124749</span><span class="p">,</span> <span class="mf">23.00637</span><span class="p">]});</span><span class="c1">//终点</span>



 <span class="nx">truckDriving</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">status</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
     <span class="c1">// result即是对应的货车导航信息，相关数据结构文档请参考 https://lbs.amap.com/api/javascript-api/reference/route-search#m_DrivingResult</span>
     <span class="k">if</span> <span class="p">(</span><span class="nx">status</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">complete</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
         <span class="c1">//log.success('绘制货车路线完成')</span>

         <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">routes</span> <span class="o">&amp;&amp;</span> <span class="nx">result</span><span class="p">.</span><span class="nx">routes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
             <span class="nx">drawRoute</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">routes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
         <span class="p">}</span>
     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
         <span class="c1">//log.error('获取货车规划数据失败：' + result)</span>
     <span class="p">}</span>
 <span class="p">})</span>


 <span class="c1">// 画路线</span>
 <span class="kd">function</span> <span class="nx">drawRoute</span> <span class="p">(</span><span class="nx">route</span><span class="p">)</span> <span class="p">{</span>
     <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">parseRouteToPath</span><span class="p">(</span><span class="nx">route</span><span class="p">)</span>

     <span class="kd">var</span> <span class="nx">startMarker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nx">Marker</span><span class="p">({</span>
         <span class="na">position</span><span class="p">:</span> <span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
         <span class="na">icon</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://webapi.amap.com/theme/v1.3/markers/n/start.png</span><span class="dl">'</span><span class="p">,</span>
         <span class="na">map</span><span class="p">:</span> <span class="nx">map</span><span class="p">,</span>
         <span class="na">anchor</span><span class="p">:</span> <span class="dl">'</span><span class="s1">bottom-center</span><span class="dl">'</span><span class="p">,</span>
     <span class="p">})</span>

     <span class="kd">var</span> <span class="nx">endMarker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nx">Marker</span><span class="p">({</span>
         <span class="na">position</span><span class="p">:</span> <span class="nx">path</span><span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
         <span class="na">icon</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://webapi.amap.com/theme/v1.3/markers/n/end.png</span><span class="dl">'</span><span class="p">,</span>
         <span class="na">map</span><span class="p">:</span> <span class="nx">map</span><span class="p">,</span>
         <span class="na">anchor</span><span class="p">:</span> <span class="dl">'</span><span class="s1">bottom-center</span><span class="dl">'</span><span class="p">,</span>
     <span class="p">})</span>

     <span class="kd">var</span> <span class="nx">routeLine</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nx">Polyline</span><span class="p">({</span>
         <span class="na">path</span><span class="p">:</span> <span class="nx">path</span><span class="p">,</span>
         <span class="na">isOutline</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
         <span class="na">outlineColor</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#ffeeee</span><span class="dl">'</span><span class="p">,</span>
         <span class="na">borderWeight</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
         <span class="na">strokeWeight</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
         <span class="na">strokeOpacity</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
         <span class="na">strokeColor</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#0091ff</span><span class="dl">'</span><span class="p">,</span>
         <span class="na">lineJoin</span><span class="p">:</span> <span class="dl">'</span><span class="s1">round</span><span class="dl">'</span>
     <span class="p">})</span>

     <span class="nx">map</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">routeLine</span><span class="p">);</span>
     <span class="c1">// 调整视野达到最佳显示区域</span>
     <span class="nx">map</span><span class="p">.</span><span class="nx">setFitView</span><span class="p">([</span> <span class="nx">startMarker</span><span class="p">,</span> <span class="nx">endMarker</span><span class="p">,</span> <span class="nx">routeLine</span> <span class="p">])</span>
     <span class="c1">//</span>
     <span class="nx">drawPath</span><span class="p">();</span>
     <span class="nx">map</span><span class="p">.</span><span class="nx">setZoom</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="c1">// 解析DrivingRoute对象，构造成AMap.Polyline的path参数需要的格式</span>
 <span class="c1">// DrivingResult对象结构参考文档 https://lbs.amap.com/api/javascript-api/reference/route-search#m_DriveRoute</span>
 <span class="kd">function</span> <span class="nx">parseRouteToPath</span><span class="p">(</span><span class="nx">route</span><span class="p">)</span> <span class="p">{</span>
     <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">route</span><span class="p">.</span><span class="nx">steps</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="kd">var</span> <span class="nx">step</span> <span class="o">=</span> <span class="nx">route</span><span class="p">.</span><span class="nx">steps</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>

         <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">step</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
             <span class="nx">path</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">step</span><span class="p">.</span><span class="nx">path</span><span class="p">[</span><span class="nx">j</span><span class="p">])</span>
         <span class="p">}</span>
     <span class="p">}</span>

     <span class="k">return</span> <span class="nx">path</span>
 <span class="p">}</span>



<span class="c1">// 路线规划好后，画出已行驶路线</span>

 <span class="c1">//轨迹演示</span>
 <span class="cm">/*;

 113.466393,23.16349;113.466124,23.163199;113.466024,23.163116;113.465586,23.162886;113.465469,23.162873;113.465334,23.162869;113.464753,23.162865;113.464288,23.162878;113.463902,23.162912;113.462956,23.163025;113.461311,23.16322;113.460981,23.16326;113.460326,23.163342;113.460104,23.163368;113.458754,23.163628;113.457943,23.163759;113.457465,23.163811;113.457331,23.163828;113.456879,23.163889;113.456059,23.163984
 
 */</span>
 <span class="kd">var</span> <span class="nx">marker</span><span class="p">,</span> <span class="nx">lineArr</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">[</span><span class="mf">113.465972</span><span class="p">,</span><span class="mf">23.167452</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.465964</span><span class="p">,</span><span class="mf">23.167335</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.465968</span><span class="p">,</span><span class="mf">23.167174</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.465924</span><span class="p">,</span><span class="mf">23.166984</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.465556</span><span class="p">,</span><span class="mf">23.165217</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.465707</span><span class="p">,</span><span class="mf">23.165074</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.465777</span><span class="p">,</span><span class="mf">23.165048</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.466662</span><span class="p">,</span><span class="mf">23.164813</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.466662</span><span class="p">,</span><span class="mf">23.164813</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.466632</span><span class="p">,</span><span class="mf">23.164683</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.466576</span><span class="p">,</span><span class="mf">23.164375</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.466428</span><span class="p">,</span><span class="mf">23.163689</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.466393</span><span class="p">,</span><span class="mf">23.16349</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.466393</span><span class="p">,</span><span class="mf">23.16349</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.466124</span><span class="p">,</span><span class="mf">23.163199</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.465586</span><span class="p">,</span><span class="mf">23.162886</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.465334</span><span class="p">,</span><span class="mf">23.162869</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.464753</span><span class="p">,</span><span class="mf">23.162865</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">113.463902</span><span class="p">,</span><span class="mf">23.162912</span><span class="p">]</span>
      <span class="p">];</span>

 
 <span class="nx">marker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nx">Marker</span><span class="p">({</span>
     <span class="na">map</span><span class="p">:</span> <span class="nx">map</span><span class="p">,</span>
     <span class="na">position</span><span class="p">:</span> <span class="p">[</span><span class="mf">113.464753</span><span class="p">,</span><span class="mf">23.162865</span><span class="p">],</span>
     <span class="na">icon</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://webapi.amap.com/images/car.png</span><span class="dl">"</span><span class="p">,</span>
     <span class="na">offset</span><span class="p">:</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nx">Pixel</span><span class="p">(</span><span class="o">-</span><span class="mi">26</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">),</span>
     <span class="na">autoRotation</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
     <span class="na">angle</span><span class="p">:</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span>
 <span class="p">});</span>

 <span class="kd">function</span> <span class="nx">drawPath</span><span class="p">(){</span>

 
     <span class="c1">// 绘制轨迹</span>
     <span class="kd">var</span> <span class="nx">polyline</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nx">Polyline</span><span class="p">({</span>
         <span class="na">map</span><span class="p">:</span> <span class="nx">map</span><span class="p">,</span>
         <span class="na">path</span><span class="p">:</span> <span class="nx">lineArr</span><span class="p">,</span>
         <span class="na">showDir</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
         <span class="na">strokeColor</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#AF5</span><span class="dl">"</span><span class="p">,</span><span class="c1">//"#28F",  //线颜色</span>
         <span class="c1">// strokeOpacity: 1,     //线透明度</span>
         <span class="na">strokeWeight</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>      <span class="c1">//线宽</span>
         <span class="c1">// strokeStyle: "solid"  //线样式</span>
     <span class="p">});</span>


     <span class="kd">var</span> <span class="nx">passedPolyline</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AMap</span><span class="p">.</span><span class="nx">Polyline</span><span class="p">({</span>
         <span class="na">map</span><span class="p">:</span> <span class="nx">map</span><span class="p">,</span>
         <span class="c1">// path: lineArr,</span>
         <span class="na">strokeColor</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#AF5</span><span class="dl">"</span><span class="p">,</span>  <span class="c1">//线颜色</span>
         <span class="c1">// strokeOpacity: 1,     //线透明度</span>
         <span class="na">strokeWeight</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>      <span class="c1">//线宽</span>
         <span class="c1">// strokeStyle: "solid"  //线样式</span>
     <span class="p">});</span>


     <span class="nx">marker</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">moving</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">passedPolyline</span><span class="p">.</span><span class="nx">setPath</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">passedPath</span><span class="p">);</span>
     <span class="p">});</span>
     
     <span class="nx">map</span><span class="p">.</span><span class="nx">setFitView</span><span class="p">();</span>

     <span class="nx">marker</span><span class="p">.</span><span class="nx">moveAlong</span><span class="p">([</span><span class="nx">lineArr</span><span class="p">[</span><span class="nx">lineArr</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span><span class="nx">lineArr</span><span class="p">[</span><span class="nx">lineArr</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="mi">200</span><span class="p">);</span>
 <span class="p">}</span>
</code></pre></div></div>

<p>记录一次开发试用记录，学习请看官网API，描写详细清晰</p>
